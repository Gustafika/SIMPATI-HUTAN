<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SIMPATI HUTAN ‚Äî Demo (Modern)</title>
  <style>
    :root{
      --bg:#0b1220;
      --panel:#0f1a30;
      --card:#0f1a30;
      --card2:#101f3a;
      --text:#e6edf7;
      --muted:#a7b4cc;
      --line:rgba(255,255,255,.10);
      --brand:#7c3aed;
      --brand2:#22c55e;
      --warn:#f59e0b;
      --shadow: 0 18px 50px rgba(0,0,0,.35);
      --radius:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, Helvetica, sans-serif;
      background: radial-gradient(1200px 700px at 10% 10%, #1b2b5a 0%, rgba(27,43,90,0) 60%),
                  radial-gradient(1100px 700px at 90% 20%, #2b1d63 0%, rgba(43,29,99,0) 55%),
                  var(--bg);
      color:var(--text);
    }
    a{color:inherit}
    .wrap{max-width:1180px;margin:0 auto;padding:26px 18px 60px;}
    .topbar{
      display:flex;align-items:center;justify-content:space-between;gap:12px;
      padding:16px 18px;border:1px solid var(--line);border-radius:var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
    }
    .brand{
      display:flex;align-items:center;gap:12px;flex-wrap:wrap;
    }
    .logo{
      width:42px;height:42px;border-radius:14px;
      background: linear-gradient(135deg, var(--brand), #2563eb);
      display:grid;place-items:center;
      box-shadow: 0 12px 28px rgba(124,58,237,.25);
      font-weight:800;
    }
    .title h1{margin:0;font-size:20px;letter-spacing:.2px}
    .title p{margin:4px 0 0;color:var(--muted);font-size:12.5px;line-height:1.35}
    .pill{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 12px;border-radius:999px;border:1px solid var(--line);
      background: rgba(255,255,255,.05);
      color:var(--muted);font-size:12px;white-space:nowrap;
    }
    .pill b{color:var(--text);font-weight:650}
    .grid{
      display:grid;grid-template-columns: 1.1fr .9fr;gap:14px;margin-top:14px;
    }
    @media (max-width: 980px){ .grid{grid-template-columns:1fr;} }

    .card{
      border:1px solid var(--line);
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      box-shadow: var(--shadow);
      padding:16px;
    }
    .cardHeader{
      display:flex;align-items:flex-start;justify-content:space-between;gap:10px;margin-bottom:12px;
    }
    .cardHeader h2{margin:0;font-size:16px}
    .cardHeader .small{color:var(--muted);font-size:12px;line-height:1.3}
    .divider{height:1px;background:var(--line);margin:12px 0;}
    .steps{display:flex;gap:8px;flex-wrap:wrap}
    .stepDot{
      display:flex;align-items:center;gap:8px;
      padding:8px 10px;border-radius:999px;border:1px solid var(--line);
      background: rgba(0,0,0,.12);font-size:12px;color:var(--muted);
    }
    .stepDot.active{border-color: rgba(124,58,237,.55); color:var(--text)}
    .stepDot.done{border-color: rgba(34,197,94,.55); color:var(--text)}
    .formGrid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media (max-width: 640px){ .formGrid{grid-template-columns:1fr} }
    label{display:block;font-size:12px;color:var(--muted);margin:10px 0 6px}
    select,input{
      width:100%;
      padding:11px 12px;
      border-radius: 14px;
      border:1px solid var(--line);
      background: rgba(0,0,0,.18);
      color:var(--text);
      outline:none;
      font-size:13.5px;
    }
    select:disabled,input:disabled{opacity:.55}
    option{color:#0b1220}
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    button{
      border:1px solid var(--line);
      background: linear-gradient(135deg, rgba(124,58,237,.95), rgba(37,99,235,.95));
      color:var(--text);
      padding:10px 12px;border-radius:14px;
      cursor:pointer;font-size:13px;font-weight:650;
    }
    button.secondary{
      background: rgba(255,255,255,.06);
      color:var(--text);
    }
    button.ghost{
      background: transparent;
      color: var(--text);
    }
    button:disabled{opacity:.5;cursor:not-allowed}
    .quick{
      display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-top:10px;
    }
    @media (max-width: 860px){ .quick{grid-template-columns:1fr} }
    .quick button{
      background: rgba(255,255,255,.06);
      border: 1px solid var(--line);
      font-weight:650;
    }
    .quick button:hover{border-color: rgba(255,255,255,.25)}
    .tag{
      display:inline-flex;align-items:center;
      padding:4px 10px;border-radius:999px;font-size:12px;border:1px solid var(--line);
      background: rgba(255,255,255,.06);color:var(--muted);
    }
    .tag.green{border-color: rgba(34,197,94,.55); color:#bbf7d0; background: rgba(34,197,94,.10);}
    .tag.blue{border-color: rgba(59,130,246,.55); color:#bfdbfe; background: rgba(59,130,246,.10);}
    .tag.orange{border-color: rgba(245,158,11,.55); color:#fde68a; background: rgba(245,158,11,.12);}
    .tag.gray{color:var(--muted)}
    .resultTitle{display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap}
    .kartu{
      margin-top:12px;
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding:14px;
      background: rgba(0,0,0,.14);
    }
    .kartu h3{margin:0 0 6px;font-size:18px}
    .meta{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px}
    @media (max-width: 640px){ .meta{grid-template-columns:1fr} }
    .metaBox{
      border:1px solid var(--line);
      border-radius:14px;
      padding:10px 12px;
      background: rgba(255,255,255,.04);
      color:var(--muted);font-size:12.5px;
    }
    .metaBox b{color:var(--text)}
    .secTitle{margin:12px 0 6px;color:var(--text);font-size:13px}
    ul{margin:6px 0 0;padding-left:18px;color:var(--muted);font-size:13px;line-height:1.45}
    .note{
      margin-top:12px;
      padding:10px 12px;border-radius:14px;
      border:1px dashed rgba(255,255,255,.25);
      background: rgba(255,255,255,.04);
      color: var(--muted);
      font-size:12px;
    }
    .foot{
      margin-top:14px;color:var(--muted);font-size:12px;line-height:1.4
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <div class="logo">SH</div>
        <div class="title">
          <h1>SIMPATI HUTAN</h1>
          <p>Prototype aplikasi web interaktif (offline/online) berbasis decision tree untuk rekomendasi mekanisme perizinan kawasan hutan (Permen LHK 7/2021 Bab III & IV).</p>
        </div>
      </div>
      <div class="pill"><b>Mode</b> Static Web App ‚Ä¢ GitHub Pages</div>
    </div>

    <div class="grid">
      <!-- LEFT -->
      <div class="card">
        <div class="cardHeader">
          <div>
            <h2>Wizard Penentuan Mekanisme</h2>
            <div class="small">Mulai dari kegiatan ‚Üí status kawasan ‚Üí luasan ‚Üí tahap ‚Üí hasil.</div>
          </div>
          <div class="tag gray" id="statusTag">Belum dihitung</div>
        </div>

        <div class="steps">
          <div class="stepDot active" id="dot1">1. Kegiatan</div>
          <div class="stepDot" id="dot2">2. Status</div>
          <div class="stepDot" id="dot3">3. Luasan</div>
          <div class="stepDot" id="dot4">4. Tahap</div>
        </div>

        <div class="divider"></div>

        <label for="kegiatan">Kegiatan (detail sesuai regulasi)</label>
        <select id="kegiatan">
          <option value="">‚Äî Pilih ‚Äî</option>

          <optgroup label="A. PPKH (Bab IV) ‚Äî Pasal 367 (Keputusan Menteri)">
            <option value="ppkh|religi">Religi (tempat ibadah/pemakaman nonkomersial/wisata rohani)</option>
            <option value="ppkh|pertambangan">Pertambangan (mineral/batubara/migas + sarpras)</option>
            <option value="ppkh|ketenagalistrikan">Ketenagalistrikan (pembangkit/transmisi/distribusi)</option>
            <option value="ppkh|panas_bumi">Panas bumi</option>
            <option value="ppkh|telekomunikasi">Telekomunikasi (jaringan/pemancar/relay/stasiun bumi)</option>
            <option value="ppkh|jalan_tol_kereta">Jalan umum / jalan tol / jalur kereta api</option>
            <option value="ppkh|transportasi_non_umum_angkutan_produksi">Transportasi non-umum angkutan hasil produksi non tambang</option>
            <option value="ppkh|waduk_bendungan_irigasi_sanitasi">Waduk/bendungan/irigasi/air minum/sanitasi</option>
            <option value="ppkh|fasilitas_umum_permukiman">Fasilitas umum termasuk permukiman (terbangun)</option>
            <option value="ppkh|industri_non_primer_hh">Industri selain industri primer hasil hutan</option>
            <option value="ppkh|hankam">Pertahanan dan keamanan</option>
            <option value="ppkh|keselamatan_umum">Prasarana penunjang keselamatan umum</option>
            <option value="ppkh|evakuasi_bencana_sementara">Jalur evakuasi bencana/penampungan sementara</option>
            <option value="ppkh|pertanian_ketahanan_pangan">Pertanian tertentu untuk Ketahanan Pangan</option>
            <option value="ppkh|pertanian_ketahanan_energi">Pertanian tertentu untuk Ketahanan Energi</option>
            <option value="ppkh|tpa_limbah_pemulihan">TPA/pengolahan limbah/pemulihan lingkungan</option>
          </optgroup>

          <optgroup label="B. Kerja Sama (Bab IV) ‚Äî Pasal 384 (Surat Dirjen)">
            <option value="kerjasama|religi">Sarana religi (nonkomersil)</option>
            <option value="kerjasama|wisata_budaya">Wisata budaya & penunjang (nonkomersial)</option>
            <option value="kerjasama|kabel_sepanjang_alur">Penanaman/pemasangan kabel sepanjang alur/jalan</option>
            <option value="kerjasama|pltmh">PLTMH (‚â§ 1 MW)</option>
            <option value="kerjasama|listrik_desa_telekom">Listrik desa ‚â§70 kV / telekom bawah tanah/bertiang</option>
            <option value="kerjasama|kanal_irigasi_tanggul">Kanal/irigasi/tanggul banjir/abrasi</option>
            <option value="kerjasama|rest_area_keselamatan">Rest area & sarana keselamatan lalu lintas darat</option>
            <option value="kerjasama|peningkatan_alur_jalan">Peningkatan alur/jalan (tanpa pelebaran/jalan baru)</option>
            <option value="kerjasama|embung_cekdam_sabo">Embung/cek dam/sabo/air minum/penampungan air</option>
            <option value="kerjasama|papan_iklan_portal_tugu">Papan iklan/portal/gardu pandang/tugu</option>
            <option value="kerjasama|penanaman_reklamasi_rehab">Penanaman untuk reklamasi & rehabilitasi hutan</option>
            <option value="kerjasama|latihan_tempur_sarpras">Daerah latihan tempur & sarana penunjang (terbatas)</option>
            <option value="kerjasama|alat_ukur_klimatologi">Penempatan alat ukur klimatologi & geofisika</option>
            <option value="kerjasama|bumi_perkemahan">Bumi perkemahan</option>
            <option value="kerjasama|menara_telekom">Menara telekomunikasi</option>
            <option value="kerjasama|lapangan_tembak">Lapangan tembak</option>
            <option value="kerjasama|pascatambang_tailing_dam">Pasca tambang (pemeliharaan tailing/dam)</option>
          </optgroup>

          <optgroup label="C. Survei (Bab IV) ‚Äî Surat Dirjen">
            <option value="survei|survei">Survei (khusus kegiatan survei)</option>
          </optgroup>

          <optgroup label="D. Bab III (Perubahan Peruntukan/Fungsi)">
            <option value="pelepasan|pelepasan">Pelepasan Kawasan Hutan</option>
            <option value="perubahan_fungsi|perubahan_fungsi">Perubahan Fungsi Kawasan Hutan</option>
          </optgroup>
        </select>

        <div class="formGrid">
          <div>
            <label for="status">Status kawasan</label>
            <select id="status" disabled>
              <option value="">‚Äî Pilih ‚Äî</option>
              <option value="hl">Hutan Lindung (HL)</option>
              <option value="hp">Hutan Produksi (HP)</option>
              <option value="hpk">HPK</option>
              <option value="hk">Hutan Konservasi (HK)</option>
            </select>
          </div>
          <div>
            <label for="tahap">Tahap kegiatan</label>
            <select id="tahap" disabled>
              <option value="">‚Äî Pilih ‚Äî</option>
              <option value="survei">Survei</option>
              <option value="perencanaan">Perencanaan</option>
              <option value="konstruksi">Konstruksi</option>
              <option value="operasi">Operasi</option>
            </select>
          </div>
        </div>

        <div class="formGrid">
          <div>
            <label for="luas">Luasan (Ha)</label>
            <input id="luas" type="number" min="0" step="0.01" placeholder="contoh: 20" disabled />
          </div>
          <div>
            <label for="fasilitas">Khusus PPKH: fasilitas umum nonkomersial?</label>
            <select id="fasilitas" disabled>
              <option value="tidak">Tidak</option>
              <option value="ya">Ya</option>
            </select>
          </div>
        </div>

        <div class="actions">
          <button id="btnHasil" onclick="generate()" disabled>Lihat Rekomendasi</button>
          <button class="secondary" onclick="resetAll()">Reset</button>
          <button class="ghost" onclick="toggleTips()">Tips Seminar</button>
        </div>

        <div class="note" id="tips" style="display:none;">
          <b>Tips demo seminar (biar selalu ‚Äúberhasil‚Äù):</b>
          <ul>
            <li>PPKH: Pertambangan ‚Üí Status HP ‚Üí Luas 20 ‚Üí Tahap konstruksi</li>
            <li>Survei: Survei ‚Üí Status HL ‚Üí Tahap survei</li>
            <li>Pelepasan: Pelepasan ‚Üí Status HPK ‚Üí (jelaskan verifikasi kriteria)</li>
          </ul>
          <div class="divider"></div>
          <b>Disarankan:</b> gunakan tombol ‚ÄúDemo Cepat‚Äù di bawah saat presentasi.
        </div>

        <div class="divider"></div>
        <div class="cardHeader" style="margin-bottom:8px;">
          <div>
            <h2>Demo Cepat (1 klik)</h2>
            <div class="small">Mengisi form otomatis dengan skenario valid untuk seminar.</div>
          </div>
          <span class="pill"><b>Seminar</b> ready</span>
        </div>

        <div class="quick">
          <button onclick="preset('ppkh')">Skenario PPKH ‚Ä¢ Pertambangan di HP</button>
          <button onclick="preset('survei')">Skenario Survei ‚Ä¢ HL</button>
          <button onclick="preset('pelepasan')">Skenario Pelepasan ‚Ä¢ HPK</button>
        </div>

        <div class="foot">
          ‚ö†Ô∏è <b>Disclaimer:</b> Ini alat bantu interpretasi regulasi (rekomendasi awal), tidak menggantikan kewenangan pejabat berwenang.
        </div>
      </div>

      <!-- RIGHT -->
      <div class="card">
        <div class="resultTitle">
          <div>
            <h2 style="margin:0 0 4px;">Hasil Rekomendasi</h2>
            <div class="small" style="color:var(--muted);font-size:12px;">Menampilkan mekanisme + ringkasan persyaratan + tata cara (ringkas).</div>
          </div>
          <span class="tag gray" id="pill">Belum ada hasil</span>
        </div>

        <div class="divider"></div>

        <div id="output" style="color:var(--muted);font-size:13px;line-height:1.5;">
          Isi form di kiri lalu klik <b>Lihat Rekomendasi</b>, atau gunakan <b>Demo Cepat</b>.
        </div>
      </div>
    </div>
  </div>

<script>
  const el = (id) => document.getElementById(id);

  const kegiatanEl = el("kegiatan");
  const statusEl   = el("status");
  const luasEl     = el("luas");
  const fasilitasEl= el("fasilitas");
  const tahapEl    = el("tahap");
  const btnHasil   = el("btnHasil");
  const pill       = el("pill");
  const output     = el("output");
  const statusTag  = el("statusTag");

  const dot1 = el("dot1"), dot2 = el("dot2"), dot3 = el("dot3"), dot4 = el("dot4");

  function setDot(dot, state){
    dot.classList.remove("active","done");
    dot.classList.add(state);
  }
  function parseKegiatan(v){
    if(!v || v.indexOf("|")===-1) return {tipe:"", kode:""};
    const [tipe, kode] = v.split("|");
    return {tipe, kode};
  }
  function statusText(s){
    return s==="hl" ? "Hutan Lindung (HL)" :
           s==="hp" ? "Hutan Produksi (HP)" :
           s==="hpk"? "HPK" :
           s==="hk" ? "Hutan Konservasi (HK)" : "‚Äî";
  }
  function setTag(kind, text){
    pill.className = "tag " + kind;
    pill.textContent = text;
  }
  function setStatusTag(text){
    statusTag.textContent = text;
  }

  function toggleTips(){
    const t = el("tips");
    t.style.display = (t.style.display==="none") ? "block" : "none";
  }

  function enableFlow(){
    const v = kegiatanEl.value;
    const {tipe} = parseKegiatan(v);
    const enabled = !!v;

    statusEl.disabled = !enabled;
    tahapEl.disabled  = !enabled;
    luasEl.disabled   = !enabled;
    fasilitasEl.disabled = !(tipe==="ppkh");

    if(tipe==="survei") tahapEl.value = "survei";

    setDot(dot1, enabled ? "done" : "active");
    setDot(dot2, enabled ? "active" : "active");
    setDot(dot3, "active");
    setDot(dot4, "active");
    updateButton();
  }

  function updateButton(){
    btnHasil.disabled = !(kegiatanEl.value && statusEl.value && tahapEl.value);
  }

  function card({title, tagKind, tagText, authority, basis, req, steps, notes, warning}){
    setTag(tagKind, tagText);
    setStatusTag(tagText);
    const liReq = req.map(x=>`<li>${x}</li>`).join("");
    const liSteps = steps.map(x=>`<li>${x}</li>`).join("");
    const liNotes = notes.map(x=>`<li>${x}</li>`).join("");
    output.innerHTML = `
      <div class="kartu">
        <h3>${title}</h3>
        <div class="meta">
          <div class="metaBox"><b>Otoritas</b><br>${authority}</div>
          <div class="metaBox"><b>Dasar (ringkas)</b><br>${basis}</div>
        </div>

        <div class="secTitle">üìÑ Persyaratan Utama (ringkas)</div>
        <ul>${liReq}</ul>

        <div class="secTitle">‚öô Mekanisme Tata Cara (ringkas)</div>
        <ul>${liSteps}</ul>

        <div class="secTitle">üìå Catatan</div>
        <ul>${liNotes}</ul>

        ${warning ? `<div class="note">${warning}</div>` : ``}
      </div>
    `;
  }

  function invalidBabIV(currentStatus){
    return card({
      title: "Perlu verifikasi (status kawasan tidak sesuai jalur Bab IV)",
      tagKind: "orange",
      tagText: "Perlu verifikasi",
      authority: "‚Äî",
      basis: "Bab IV (Penggunaan Kawasan Hutan) umumnya berlaku pada HL/HP.",
      req: [
        "Verifikasi status kawasan lokasi (idealnya berbasis peta/GIS).",
        "Jika lokasi HPK dan tujuan keluar kawasan ‚Üí jalur Pelepasan (Bab III).",
        "Jika Hutan Konservasi ‚Üí mekanisme berbeda (di luar demo ini)."
      ],
      steps: ["Koreksi input status kawasan.", "Lakukan verifikasi teknis bila perlu."],
      notes: [`Status saat ini: <b>${currentStatus}</b>.`],
      warning: "Demo ini fokus pada penentuan jalur (rekomendasi awal), bukan keputusan final."
    });
  }

  function generate(){
    const {tipe, kode} = parseKegiatan(kegiatanEl.value);
    const s = statusEl.value;
    const luas = parseFloat(luasEl.value || "0");
    const fasilitas = fasilitasEl.value === "ya";
    const tahap = tahapEl.value || "‚Äî";

    const isHLHP = (s==="hl" || s==="hp");
    const isHPK  = (s==="hpk");

    const st = statusText(s);

    if(tipe === "survei"){
      if(!isHLHP) return invalidBabIV(st);
      return card({
        title: "Persetujuan Pelaksanaan Kegiatan Survei",
        tagKind: "blue",
        tagText: "Survei (Surat Dirjen)",
        authority: "Direktur Jenderal a.n. Menteri",
        basis: "Bab IV ‚Äî Persetujuan survei (ringkas).",
        req: [
          "Surat permohonan + peta lokasi (UTM WGS84) + softcopy.",
          "Dokumen lingkungan sesuai ketentuan (jika dipersyaratkan).",
          "Pakta integritas."
        ],
        steps: [
          "Permohonan ‚Üí verifikasi ‚Üí terbit persetujuan.",
          "Pelaksanaan survei & pelaporan hasil."
        ],
        notes: [
          "Berlaku pada HL/HP.",
          "Maks. 1 tahun (dapat diperpanjang).",
          "Tidak untuk penebangan/pembukaan lahan/bangunan permanen."
        ],
        warning: `Status: <b>${st}</b> ‚Ä¢ Tahap: <b>${tahap}</b>`
      });
    }

    if(tipe === "kerjasama"){
      if(!isHLHP) return invalidBabIV(st);
      return card({
        title: "Persetujuan Kerja Sama Penggunaan Kawasan Hutan",
        tagKind: "blue",
        tagText: "Kerja Sama (Surat Dirjen)",
        authority: "Direktur Jenderal a.n. Menteri",
        basis: "Bab IV ‚Äî Persetujuan kerja sama (ringkas).",
        req: [
          "Permohonan + peta lokasi (UTM WGS84) + softcopy.",
          "Dokumen lingkungan & persetujuan lingkungan (bila wajib).",
          "Kajian teknis ringkas + pakta integritas."
        ],
        steps: [
          "Permohonan ‚Üí penilaian ‚Üí terbit persetujuan.",
          "Perjanjian kerja sama ‚Üí pelaksanaan & pelaporan."
        ],
        notes: [
          "Berlaku pada HL/HP.",
          "Jangka waktu 5 tahun (dapat diperpanjang).",
          "Jika tidak ditindaklanjuti perjanjian ‚â§2 tahun ‚Üí tidak berlaku."
        ],
        warning: `Kegiatan: <b>${kode.replaceAll("_"," ")}</b> ‚Ä¢ Status: <b>${st}</b>`
      });
    }

    if(tipe === "ppkh"){
      if(!isHLHP) return invalidBabIV(st);
      const delegated = fasilitas && luas > 0 && luas <= 5;
      return card({
        title: delegated ? "PPKH (Kewenangan Dilimpahkan ‚Äî Kasus Tertentu)" : "Persetujuan Penggunaan Kawasan Hutan (PPKH)",
        tagKind: "green",
        tagText: "PPKH",
        authority: delegated ? "Gubernur (pelimpahan kewenangan, kasus tertentu)" : "Menteri (Keputusan Menteri)",
        basis: "Bab IV ‚Äî PPKH (ringkas, daftar kegiatan Pasal 367).",
        req: [
          "Pernyataan komitmen + pakta integritas.",
          "Profil pemohon/badan hukum + legalitas (bila ada).",
          "Peta lokasi (UTM WGS84) + softcopy.",
          "Dokumen lingkungan & persetujuan lingkungan (bila wajib)."
        ],
        steps: [
          "Permohonan (OSS/layanan) ‚Üí verifikasi administrasi.",
          "Penilaian teknis ‚Üí konsep keputusan ‚Üí terbit keputusan."
        ],
        notes: [
          "Berlaku pada HL/HP.",
          `Kegiatan: <b>${kode.replaceAll("_"," ")}</b>.`,
          delegated ? "Fasilitas umum nonkomersial ‚â§5 Ha ‚Üí potensi pelimpahan." : "Jika fasilitas umum nonkomersial ‚â§5 Ha ‚Üí potensi pelimpahan."
        ],
        warning: `Status: <b>${st}</b> ‚Ä¢ Luas: <b>${isNaN(luas)?0:luas}</b> Ha ‚Ä¢ Tahap: <b>${tahap}</b>`
      });
    }

    if(tipe === "pelepasan"){
      if(!isHPK){
        return card({
          title: "Pelepasan Kawasan Hutan (Perlu verifikasi status kawasan)",
          tagKind: "orange",
          tagText: "Bab III",
          authority: "Sesuai ketentuan Bab III",
          basis: "Bab III ‚Äî Pelepasan (ringkas).",
          req: [
            "Peta usulan + dokumen rencana pemanfaatan.",
            "Verifikasi status kawasan (umumnya HPK).",
            "Dokumen lingkungan bila dipersyaratkan."
          ],
          steps: ["Permohonan ‚Üí verifikasi status/kriteria ‚Üí penilaian teknis ‚Üí penetapan."],
          notes: [`Status saat ini: <b>${st}</b>.`, "Untuk demo seminar: tekankan pemilahan jalur (PPKH vs Pelepasan)."],
          warning: "Ini rekomendasi awal, bukan keputusan final."
        });
      }
      return card({
        title: "Pelepasan Kawasan Hutan",
        tagKind: "orange",
        tagText: "Bab III",
        authority: "Sesuai ketentuan Bab III",
        basis: "Bab III ‚Äî Perubahan peruntukan menjadi bukan kawasan hutan (ringkas).",
        req: [
          "Peta usulan pelepasan + data lokasi, luas, batas.",
          "Dokumen pendukung rencana pemanfaatan/pembangunan.",
          "Verifikasi kriteria teknis (status HPK, dsb)."
        ],
        steps: ["Permohonan ‚Üí verifikasi administratif ‚Üí penilaian teknis ‚Üí rekomendasi ‚Üí penetapan."],
        notes: ["Umumnya pada HPK.", "Modul versi penuh akan memuat kriteria lebih spesifik per kasus."],
        warning: `Status: <b>${st}</b> ‚Ä¢ Tahap: <b>${tahap}</b>`
      });
    }

    if(tipe === "perubahan_fungsi"){
      return card({
        title: "Perubahan Fungsi Kawasan Hutan",
        tagKind: "orange",
        tagText: "Bab III",
        authority: "Sesuai ketentuan Bab III",
        basis: "Bab III ‚Äî Perubahan fungsi (ringkas).",
        req: [
          "Usulan/permohohan sesuai pihak pengusul.",
          "Peta usulan + kajian/pertimbangan teknis.",
          "Dokumen pendukung (termasuk lingkungan bila wajib)."
        ],
        steps: ["Usulan ‚Üí verifikasi ‚Üí penilaian teknis ‚Üí penetapan."],
        notes: ["Dalam pengembangan lanjut: antar fungsi pokok vs dalam fungsi pokok."],
        warning: `Status: <b>${st}</b> ‚Ä¢ Tahap: <b>${tahap}</b>`
      });
    }

    setTag("gray","Belum ada hasil");
    setStatusTag("Belum dihitung");
    output.innerHTML = "Belum ada hasil.";
  }

  function preset(kind){
    if(kind==="ppkh"){
      kegiatanEl.value = "ppkh|pertambangan";
      statusEl.value = "hp";
      luasEl.value = "20";
      fasilitasEl.value = "tidak";
      tahapEl.value = "konstruksi";
    }
    if(kind==="survei"){
      kegiatanEl.value = "survei|survei";
      statusEl.value = "hl";
      luasEl.value = "";
      fasilitasEl.value = "tidak";
      tahapEl.value = "survei";
    }
    if(kind==="pelepasan"){
      kegiatanEl.value = "pelepasan|pelepasan";
      statusEl.value = "hpk";
      luasEl.value = "50";
      fasilitasEl.value = "tidak";
      tahapEl.value = "perencanaan";
    }
    enableFlow();
    updateButton();
    generate();
  }

  function resetAll(){
    kegiatanEl.value = "";
    statusEl.value = "";
    luasEl.value = "";
    fasilitasEl.value = "tidak";
    tahapEl.value = "";
    statusEl.disabled = true;
    tahapEl.disabled = true;
    luasEl.disabled = true;
    fasilitasEl.disabled = true;
    btnHasil.disabled = true;
    setTag("gray","Belum ada hasil");
    setStatusTag("Belum dihitung");
    setDot(dot1,"active"); setDot(dot2,"active"); setDot(dot3,"active"); setDot(dot4,"active");
    output.innerHTML = `Isi form di kiri lalu klik <b>Lihat Rekomendasi</b>, atau gunakan <b>Demo Cepat</b>.`;
  }

  kegiatanEl.addEventListener("change", () => { enableFlow(); updateButton(); });
  statusEl.addEventListener("change", updateButton);
  tahapEl.addEventListener("change", updateButton);
  luasEl.addEventListener("input", updateButton);
  fasilitasEl.addEventListener("change", updateButton);

  function enableFlow(){
    const v = kegiatanEl.value;
    const {tipe} = parseKegiatan(v);
    const enabled = !!v;

    statusEl.disabled = !enabled;
    tahapEl.disabled  = !enabled;
    luasEl.disabled   = !enabled;
    fasilitasEl.disabled = !(tipe==="ppkh");
    if(tipe==="survei") tahapEl.value = "survei";

    setDot(dot1, enabled ? "done" : "active");
    setDot(dot2, enabled ? "active" : "active");
    setDot(dot3, "active");
    setDot(dot4, "active");
  }

  resetAll();
</script>
</body>
</html>
